<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Im-Plant | Smart Gardening System</title>
<style>
  :root {
    --green: #2e7d32;
    --light-green: #66bb6a;
    --grey: #aaa;
  }
  body {
    margin: 0;
    font-family: 'Roboto', sans-serif;
    background: #f5f5f5;
    color: #222;
    overflow-x: hidden;
  }

  /* Welcome screen */
  #welcome {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    background: var(--green);
    color: white;
    font-size: 2.5rem;
    z-index: 9999;
    opacity: 0;
    transition: opacity 1s;
  }

  /* App container */
  #app {
    display: none;
    padding: 20px;
    text-align: center;
  }

  h2 {
    color: var(--green);
    font-size: 2rem;
  }

  button {
    padding: 15px 25px;
    margin: 10px;
    border: none;
    border-radius: 8px;
    background: var(--light-green);
    color: white;
    font-size: 1.1rem;
    cursor: pointer;
    transition: background 0.3s;
    min-width: 160px;
  }
  button:hover { background: var(--green); }
  button:disabled {
    background: var(--grey);
    cursor: not-allowed;
  }
  #clearData { background: #c62828; }
  #clearData:hover { background: #b71c1c; }

  input[type="text"] {
    padding: 12px;
    font-size: 1rem;
    width: 80%;
    border: 1px solid #ccc;
    border-radius: 8px;
    margin-top: 10px;
  }

  .option-list {
    max-height: 200px;
    overflow-y: auto;
    margin-top: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .option-item {
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 6px;
    width: 80%;
    padding: 10px;
    margin: 5px 0;
    cursor: pointer;
  }
  .option-item:hover {
    background: var(--light-green);
    color: white;
  }

  /* Mobile accessibility */
  @media (max-width: 768px) {
    #welcome { font-size: 1.8rem; padding: 20px; text-align: center; }
    button { font-size: 1rem; padding: 12px 18px; margin: 8px; width: 90%; }
    h2 { font-size: 1.6rem; }
    input[type="text"] { width: 90%; }
    .option-item { width: 90%; }
  }
</style>
</head>
<body>

<!-- Welcome -->
<div id="welcome">Welcome to <br><strong>Im-Plant</strong></div>

<!-- Main App -->
<div id="app">
  <h2>Smart Gardening System</h2>
  <button id="plantSetupBtn">Plant Setup</button>
  <button id="plantHealthBtn" disabled>Plant Health</button>
  <button id="clearData">Clear Data</button>

  <div id="section"></div>
</div>

<script>
  const plants = [
    {name:'Basil', t:[22,32], h:[40,60]},
    {name:'Bitter Gourd (Korola)', t:[20,30], h:[60,80]},
    {name:'Bottle Gourd (Lau)', t:[22,35], h:[60,80]},
    {name:'Chili Pepper', t:[22,32], h:[50,70]},
    {name:'Coriander', t:[18,27], h:[50,70]},
    {name:'Garlic', t:[10,25], h:[40,60]},
    {name:'Hibiscus', t:[22,32], h:[60,80]},
    {name:'Jasmine', t:[20,30], h:[60,70]},
    {name:'Lemon', t:[20,32], h:[50,70]},
    {name:'Lemongrass', t:[22,32], h:[60,80]},
    {name:'Lettuce', t:[15,25], h:[60,80]},
    {name:'Marigold', t:[18,30], h:[50,70]},
    {name:'Mint', t:[18,25], h:[60,80]},
    {name:'Neem Tree', t:[25,40], h:[30,50]},
    {name:'Onion', t:[18,30], h:[50,70]},
    {name:'Oregano', t:[20,30], h:[40,60]},
    {name:'Papaya', t:[22,35], h:[50,70]},
    {name:'Parsley', t:[15,25], h:[60,70]},
    {name:'Petunia', t:[15,25], h:[50,70]},
    {name:'Potato', t:[15,25], h:[60,70]},
    {name:'Pumpkin', t:[20,30], h:[60,70]},
    {name:'Sunflower', t:[20,32], h:[50,60]},
    {name:'Thyme', t:[18,30], h:[40,60]},
    {name:'Tomato', t:[20,30], h:[50,70]}
  ];

  const dom = {
    welcome: document.getElementById('welcome'),
    app: document.getElementById('app'),
    section: document.getElementById('section'),
    setupBtn: document.getElementById('plantSetupBtn'),
    healthBtn: document.getElementById('plantHealthBtn'),
    clearData: document.getElementById('clearData')
  };

  let confirmedPlant = localStorage.getItem('confirmedPlant') || null;
  applyHealthButtonState();

  function applyHealthButtonState() {
    if (confirmedPlant) {
      dom.healthBtn.disabled = false;
      dom.healthBtn.style.background = 'var(--light-green)';
    } else {
      dom.healthBtn.disabled = true;
      dom.healthBtn.style.background = 'var(--grey)';
    }
  }

  function showWelcome() {
    dom.welcome.style.display = 'flex';
    requestAnimationFrame(() => dom.welcome.style.opacity = '1');
    const proceed = () => {
      dom.welcome.style.opacity = '0';
      setTimeout(() => {
        dom.welcome.style.display = 'none';
        dom.app.style.display = 'block';
      }, 1000);
      ['click','wheel','keydown','touchstart'].forEach(e => window.removeEventListener(e, proceed));
    };
    ['click','wheel','keydown','touchstart'].forEach(e => window.addEventListener(e, proceed, {once:true}));
  }

  showWelcome();

  dom.setupBtn.onclick = showPlantSetup;
  dom.healthBtn.onclick = () => {
    if (confirmedPlant) showPlantMonitoring();
  };
  dom.clearData.onclick = () => {
    localStorage.removeItem('confirmedPlant');
    confirmedPlant = null;
    applyHealthButtonState();
    dom.section.innerHTML = '';
  };

  function showPlantSetup() {
    dom.section.innerHTML = `
      <h3>Plant Health</h3>
      <button id="suggestPlant">Suggest a Plant</button>
      <button id="alreadyPlanted">I Already Planted One</button>
      <button id="backToMain">Back</button>
    `;
    document.getElementById('suggestPlant').onclick = showSuggestPlant;
    document.getElementById('alreadyPlanted').onclick = showAlreadyPlanted;
    document.getElementById('backToMain').onclick = () => dom.section.innerHTML = '';
  }

  function showSuggestPlant() {
    const temp = 26, humidity = 65;
    const suitable = plants.filter(p => temp >= p.t[0] && temp <= p.t[1] && humidity >= p.h[0] && humidity <= p.h[1])
                            .sort((a,b)=>a.name.localeCompare(b.name));
    dom.section.innerHTML = `<h3>Suggested Plants</h3>
      <div class="option-list">
        ${suitable.map(p=>`<div class="option-item" data-name="${p.name}">${p.name}</div>`).join('')}
      </div>
      <button id="confirm">Confirm</button>
      <button id="back">Back</button>`;
    document.getElementById('back').onclick = showPlantSetup;
    document.querySelectorAll('.option-item').forEach(el => el.onclick = () => selectPlant(el.dataset.name));
    document.getElementById('confirm').onclick = () => {
      if (confirmedPlant) showPlantMonitoring();
    };
  }

  function showAlreadyPlanted() {
    dom.section.innerHTML = `
      <h3>Search for Your Plant</h3>
      <input type="text" id="searchPlant" placeholder="Type plant name...">
      <div class="option-list" id="searchResults"></div>
      <button id="back">Back</button>`;
    document.getElementById('back').onclick = showPlantSetup;
    const searchInput = document.getElementById('searchPlant');
    const results = document.getElementById('searchResults');

    searchInput.addEventListener('input', () => {
      const q = searchInput.value.toLowerCase();
      results.innerHTML = '';
      if (!q) return;
      const matched = plants.filter(p => p.name.toLowerCase().includes(q)).sort((a,b)=>a.name.localeCompare(b.name));
      matched.forEach(p => {
        const el = document.createElement('div');
        el.className = 'option-item';
        el.textContent = p.name;
        el.onclick = () => selectPlant(p.name);
        results.appendChild(el);
      });
      if (!matched.length) results.innerHTML = `<div>No match found</div>`;
    });
  }

  function selectPlant(name) {
    confirmedPlant = name;
    localStorage.setItem('confirmedPlant', name);
    applyHealthButtonState();
  }

  function showPlantMonitoring() {
    dom.section.innerHTML = `
      <h3>Monitoring ${confirmedPlant}</h3>
      <p>Temperature: 26Â°C | Humidity: 65%</p>
      <p>Soil Moisture: Optimal</p>
      <button>Water Now</button>
      <button>Auto Mode</button>
      <button id="backToMain">Back</button>
    `;
    document.getElementById('backToMain').onclick = () => dom.section.innerHTML = '';
  }
</script>

</body>
</html>
